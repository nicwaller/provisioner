[
  {
    "package": {
      "ftp": {
        "installed": false
      },
      "apache2": {
        "installed": true
      },
      "php": {
        "installed": true
      }
    },
    "observe": {
      "package[apache2]": {
        "command": "date > apache2_installed"
      },
      "package[ftp]": {
        "command": "wall Reminder to all students: insecure FTP is forbidden."
      }
    }
  },
  {
    "file_copy": {
      "/var/www/html/index.php": {
        "source": "index.php",
        "mode": "0444",
        "owner": "root",
        "group": "root"
      },
      "/etc/apache2/sites-available/000-default.conf": {
        "source": "000-default.conf",
        "conflict": "overwrite",
        "mode": "0444",
        "owner": "root",
        "group": "root"
      }
    },
    "observe": {
      "file_copy[/etc/apache2/sites-available/000-default.conf]": {
        "command": "apache2ctl configtest && (/etc/init.d/apache2 graceful || /etc/init.d/apache2 restart) && date > apache2_restarted"
      }
    }
  }
]
